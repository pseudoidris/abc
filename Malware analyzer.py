import Tkinter as tk
from Tkinter import *
from tkFileDialog import *
from tkMessageBox import *
import learning
import checkpe
import os

def train():
    learning.main()
    #pop up for success
    showinfo("Status","Training Done!")

def browsefunc():
    filename = askopenfilename()
    fileext = filename.split(".")[-1]
    if (fileext=="exe" or fileext=="dll"):
        f=open("temp.text","w")
        f.write(filename)
        f.close()
        pathlabel.config(text=filename)
    else:
        showinfo("Warning","You have provided ."+fileext+" \nFile should be in .exe or .dll format.")
        window.mainloop()

def final():
    checkpe.check()
    finalres=open("res.txt").read().strip()
    showinfo("Result...!!!",finalres)
    os.remove("res.txt")
    os.remove("temp.text")


window = tk.Tk()
window.iconbitmap('icon.ico')
window.title("Malware Analyzer")
window.geometry("600x400")

# train msg label
title = tk.Label(text="    For training the dataset Click Here :   ",font=("David",16),fg="#6383b7")
title.pack()

# train button
button = tk.Button(text="Train",command=train,width = 30)
button.pack()

# test msg label
title2 = tk.Label(text="Select the file to be Analyzed :",font=("David",16),fg="#6383b7")
title2.pack()

#file explore
browsebutton = tk.Button(text="Browse File",command=browsefunc,width = 30)
browsebutton.pack()
pathlabel = tk.Label()
pathlabel.pack()

# test msg label
title3 = tk.Label(text="Click Here to Analyze :",font=("David",16),fg="#6383b7")
title3.pack()

# submit button
button = tk.Button(text="Analyze",command=final,width = 30)
button.pack()

window.mainloop()
